STEP 2. Loading datasets...
<torch.utils.data.dataloader.DataLoader object at 0x7fe9ab1ded50>
Loaded 1000 test files
STEP 3. Loading model and metrics...
Loaded model enet2021 for decnet-completion
STEP 4. Training or eval stage...
Currently on image 0 out of 1000
Mean values per iter: {'d1': 0.9983936548233032, 'd2': 0.9994803071022034, 'd3': 0.9997637867927551, 'abs_rel': 0.012011617422103882, 'sq_rel': 0.017657754942774773, 'rmse': 0.7395699620246887, 'rmse_log': 0.024964356794953346, 'log10': 0.005166057497262955, 'silog': 0.024963390082120895}
Traceback (most recent call last):
  File "main.py", line 104, in <module>
    _, _, pred =  model(data)
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dim/depth_2022/models/enet_pro.py", line 152, in forward
    rgb_feature4 = self.rgb_encoder_layer4(rgb_feature3, geo_s3, geo_s3) # b 64 88 304
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dim/depth_2022/models/enet_basic.py", line 313, in forward
    out = self.bn1(out)
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/modules/batchnorm.py", line 179, in forward
    self.eps,
  File "/home/dim/anaconda3/envs/pytorchenv/lib/python3.7/site-packages/torch/nn/functional.py", line 2283, in batch_norm
    input, weight, bias, running_mean, running_var, training, momentum, eps, torch.backends.cudnn.enabled
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 7.80 GiB total capacity; 2.48 GiB already allocated; 46.25 MiB free; 2.50 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Currently on image 1 out of 1000